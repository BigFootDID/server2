<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>관리자</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-5">
    {% if session.is_admin %}
    <h2>🔧 관리자 패널</h2>
    <ul class="list-group mb-4">
      <li class="list-group-item"><button class="btn btn-sm btn-outline-secondary me-2" onclick="loadSubmissions()">제출 목록</button></li>
      <li class="list-group-item"><button class="btn btn-sm btn-outline-danger me-2" onclick="clearSubmissions()">목록 초기화</button></li>
    </ul>
    <ul class="list-group mb-4">
      <li class="list-group-item"><button class="btn btn-sm btn-outline-secondary me-2" onclick="loadSubmissions()">제출 목록</button></li>
      <li class="list-group-item"><button class="btn btn-sm btn-outline-danger me-2" onclick="clearSubmissions()">목록 초기화</button></li>
      <!-- 여기에 추가 -->
      <li class="list-group-item">
        <a href="/admin/download_bulk_submit" class="btn btn-sm btn-outline-primary">
          bulk_submit.txt 다운로드
        </a>
      </li>
    </ul>
    <div class="mb-3">
      <label>문제 번호</label><input id="codePid" class="form-control d-inline-block w-auto" placeholder="0058">
      <button class="btn btn-sm btn-primary ms-2" onclick="loadCode()">코드 보기</button>
    </div>
    <pre id="codeResult" class="border p-3 bg-white" style="height:200px;overflow:auto;"></pre>
    <hr>
    <h3>📝 서명 대기</h3><div id="licenseRequests"></div><hr>
    <h3>🔏 서명하기</h3>
    <div class="mb-3"><label>파일:</label><span id="selectedFilename">(선택 안됨)</span></div>
    <div class="row g-2 mb-3">
      <div class="col"><input id="signId" class="form-control" placeholder="ID"></div>
      <div class="col"><input id="signExp" class="form-control" placeholder="만료 YYYY-MM-DD"></div>
      <div class="col"><input id="signMax" type="number" class="form-control" placeholder="최대"></div>
      <div class="col-auto"><button class="btn btn-success" onclick="signSelectedLicense()">서명</button></div>
    </div>
    <hr>
    <h3>📜 서명된 라이선스</h3><div id="signedLicenses"></div>
    <hr>
    <h3>🔐 로그인 기록</h3><pre id="credLogs" class="border p-3 bg-white"></pre>
    <a href="/admin/download_credentials_log" class="btn btn-outline-primary">로그 기록 다운로드</a>
    {% else %}
    <h2>관리자 로그인</h2>
    <form onsubmit="event.preventDefault();login()" class="mb-3">
      <input id="adminId" class="form-control mb-2" placeholder="ID">
      <input id="adminPw" type="password" class="form-control mb-2" placeholder="PW">
      <button class="btn btn-primary">로그인</button>
    </form>
    {% endif %}
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="admin.js"></script>
</body>
</html>
